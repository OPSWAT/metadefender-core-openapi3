get:
  tags:
    - analysis
  summary: Fetch Analysis Result
  description: >
    Retrieve scan results.

    Scan is done asynchronously and each scan request is tracked by a data ID.
    Initiating file scans and retrieving the results need to be done using two
    separate API calls. This request needs to be made multiple times until the
    scan is complete. Scan completion can be traced using
    `scan_results.progress_percentage` value from the response.
  operationId: fileAnalysisGet
  parameters:
    - $ref: ../components/parameters/apikey.yaml
    - name: data_id
      in: path
      required: true
      schema:
        type: string
  responses:
    '200':
      description: Entire analysis report generated by MetaDefender
      content:
        application/json:
          schema:
            $ref: ../components/schemas/AnalysisResult.yaml
    '500':
      $ref: ../components/responses/Error500.yaml
