# OpenAPIClient-php

## Developer Guide
This is the API documentation for *MetaDefender Core Public API*.  If you would like to evaluate or have any questions about this documentation, please contact us via our [Contact Us](https://opswat.com/contact) form. 
## How to Interact with MetaDefender Core using REST
Beginning with MetaDefender Core 4.x, OPSWAT recommends using the JSON-based REST API. The available methods are documented below.
> _**Note**:_ MetaDefender API doesn't support chunk upload, however is recommended to stream the files to MetaDefender as part of the upload process. 
---
## File Analysis Process

  MetaDefender's main functionality is to analyze large volumes with a high throughput. Depending on the configuration and licensed technologies, the analysis times can vary. 
  Below is a brief description of the API integration flow:

  1. Upload a file for analysis (`POST /file`), which returns the `data_id`: [File Analysis](#operation/fileAnalysisPost)). 
    
    > _**Note**:_ The performance depends on:      
    > - number of nodes (scaling)
    > - number of engines per node
    > - type of file to be scanned
    > - Metadefender Core and nodes' hardware
  

  2. You have 2 ways to retrieve the analysis report: 
    - **Polling**: Fetch the result with previously received data_id (`GET /file/{data_id}` resource) until scan result belonging to data_id doesn't reach the 100 percent progress_percentage: ( [Fetch processing result](#operation/userLogin))
  
    > _**Note**:_ Too many data_id requests can reduce performance. It is enough to just check every few hundred milliseconds.
    
    - **Callbackurl**: Specify a callbackurl that will be called once the analysis is complete. 

  3. Retrieve the analysis results anytime after the analysis is completed with hash for files (md5, sha1, sha256) by calling [Fetch processing result](#operation/userLogin). 
    - The hash can be found in the scan results

  4. Retrieve processed file (sanitized, redacted, watermarked, etc.) after the analysis is complete. 
    > _**Note**:_ Based on the configured retention policy, the files might be available for retrieval at a later time. 

---
OPSWAT provides some sample codes on [GitHub](https://github.com/OPSWAT) to make it easier to understand how the MetaDefender REST API works.


This PHP package is automatically generated by the [OpenAPI Generator](https://openapi-generator.tech) project:

- API version: v4.18.0
- Build package: org.openapitools.codegen.languages.PhpClientCodegen
For more information, please visit [https://github.com/OPSWAT/metadefender-core-openapi3](https://github.com/OPSWAT/metadefender-core-openapi3)

## Requirements

PHP 5.5 and later

## Installation & Usage

### Composer

To install the bindings via [Composer](http://getcomposer.org/), add the following to `composer.json`:

```json
{
  "repositories": [
    {
      "type": "vcs",
      "url": "https://github.com/GIT_USER_ID/GIT_REPO_ID.git"
    }
  ],
  "require": {
    "GIT_USER_ID/GIT_REPO_ID": "*@dev"
  }
}
```

Then run `composer install`

### Manual Installation

Download the files and include `autoload.php`:

```php
    require_once('/path/to/OpenAPIClient-php/vendor/autoload.php');
```

## Tests

To run the unit tests:

```bash
composer install
./vendor/bin/phpunit
```

## Getting Started

Please follow the [installation procedure](#installation--usage) and then run the following:

```php
<?php
require_once(__DIR__ . '/vendor/autoload.php');



// Configure API key authorization: apikey
$config = OpenAPI\Client\Configuration::getDefaultConfiguration()->setApiKey('apikey', 'YOUR_API_KEY');
// Uncomment below to setup prefix (e.g. Bearer) for API key, if needed
// $config = OpenAPI\Client\Configuration::getDefaultConfiguration()->setApiKeyPrefix('apikey', 'Bearer');


$apiInstance = new OpenAPI\Client\Api\AdminApi(
    // If you want use custom http client, pass your client which implements `GuzzleHttp\ClientInterface`.
    // This is optional, `GuzzleHttp\Client` will be used as default.
    new GuzzleHttp\Client(),
    $config
);
$apikey = 'apikey_example'; // string | Generated `session_id` from [Login](#operation/userLogin) call can be used as an `apikey` for API calls that require authentication.
$body = 'body_example'; // \SplFileObject | 

try {
    $result = $apiInstance->adminImport($apikey, $body);
    print_r($result);
} catch (Exception $e) {
    echo 'Exception when calling AdminApi->adminImport: ', $e->getMessage(), PHP_EOL;
}

?>
```

## Documentation for API Endpoints

All URIs are relative to *http://localhost:8008*

Class | Method | HTTP request | Description
------------ | ------------- | ------------- | -------------
*AdminApi* | [**adminImport**](docs/Api/AdminApi.md#adminimport) | **POST** /admin/import | Import configuration
*AdminApi* | [**roleCreate**](docs/Api/AdminApi.md#rolecreate) | **POST** /admin/role | Create new role
*AdminApi* | [**userCreate**](docs/Api/AdminApi.md#usercreate) | **POST** /admin/user | Create user
*AnalysisApi* | [**analysisRules**](docs/Api/AnalysisApi.md#analysisrules) | **GET** /file/rules | Fetching Available Analysis Rules
*AnalysisApi* | [**fileAnalysisCancel**](docs/Api/AnalysisApi.md#fileanalysiscancel) | **POST** /file/{data_id}/cancel | Cancel File Analysis
*AnalysisApi* | [**fileAnalysisGet**](docs/Api/AnalysisApi.md#fileanalysisget) | **GET** /file/{data_id} | Fetch Analysis Result
*AnalysisApi* | [**fileAnalysisPost**](docs/Api/AnalysisApi.md#fileanalysispost) | **POST** /file | Analyze File
*AnalysisApi* | [**sanitizedFile**](docs/Api/AnalysisApi.md#sanitizedfile) | **GET** /file/converted/{data_id} | Download Sanitized Files
*AnalysisApi* | [**webhookStatus**](docs/Api/AnalysisApi.md#webhookstatus) | **GET** /file/webhook/{data_id} | Query webhook status
*AuthApi* | [**userChangePass**](docs/Api/AuthApi.md#userchangepass) | **POST** /user/changepassword | Change Password
*AuthApi* | [**userLogin**](docs/Api/AuthApi.md#userlogin) | **POST** /login | Login
*AuthApi* | [**userLogout**](docs/Api/AuthApi.md#userlogout) | **POST** /logout | Logout
*BatchApi* | [**batchCancel**](docs/Api/BatchApi.md#batchcancel) | **POST** /file/{batchId}/cancel | Cancel Batch
*BatchApi* | [**batchClose**](docs/Api/BatchApi.md#batchclose) | **POST** /file/batch/{batchId}/close | Close Batch
*BatchApi* | [**batchCreate**](docs/Api/BatchApi.md#batchcreate) | **POST** /file/batch | Initiate Batch
*BatchApi* | [**batchSignedResult**](docs/Api/BatchApi.md#batchsignedresult) | **GET** /file/batch/{batchId}/certificate | Download Signed Batch Result
*BatchApi* | [**batchStatus**](docs/Api/BatchApi.md#batchstatus) | **GET** /file/batch/{batchId} | Status of Batch Analysis
*ConfigApi* | [**configAuditLog**](docs/Api/ConfigApi.md#configauditlog) | **PUT** /admin/config/auditlog | Audit clean up
*ConfigApi* | [**configGetSkipHash**](docs/Api/ConfigApi.md#configgetskiphash) | **GET** /admin/config/skip | Get &#39;skip by hash&#39; list
*ConfigApi* | [**configQuarantine**](docs/Api/ConfigApi.md#configquarantine) | **PUT** /admin/config/quarantine | Quarantine clean up
*ConfigApi* | [**configSanitizedRepo**](docs/Api/ConfigApi.md#configsanitizedrepo) | **PUT** /admin/config/sanitize | Sanitized files clean up
*ConfigApi* | [**configScanHistory**](docs/Api/ConfigApi.md#configscanhistory) | **PUT** /admin/config/scanhistory | Processing history clean up
*ConfigApi* | [**configSession**](docs/Api/ConfigApi.md#configsession) | **PUT** /admin/config/session | Session settings
*ConfigApi* | [**configUpdate**](docs/Api/ConfigApi.md#configupdate) | **PUT** /admin/config/update | Modules Update Source and Frequency
*ConfigApi* | [**configUpdateSkipHash**](docs/Api/ConfigApi.md#configupdateskiphash) | **PUT** /admin/config/skip | Modify &#39;skip by hash&#39; list
*ConfigApi* | [**configUpdateWebhook**](docs/Api/ConfigApi.md#configupdatewebhook) | **PUT** /admin/config/webhook | Webhook set configuration
*ConfigApi* | [**configWebhook**](docs/Api/ConfigApi.md#configwebhook) | **GET** /admin/config/webhook | Webhook get configuration
*EnginesApi* | [**engineDisable**](docs/Api/EnginesApi.md#enginedisable) | **POST** /admin/engine/{engineId}/disable | Disable engines
*EnginesApi* | [**engineEnable**](docs/Api/EnginesApi.md#engineenable) | **POST** /admin/engine/{engineId}/enable | Enable engines
*EnginesApi* | [**enginePin**](docs/Api/EnginesApi.md#enginepin) | **POST** /admin/engine/{engineId}/pin | Pin engine to prevent auto-updates
*EnginesApi* | [**engineUnpin**](docs/Api/EnginesApi.md#engineunpin) | **POST** /admin/engine/{engineId}/unpin | Unpin engine to prevent auto-updates
*LicenseApi* | [**licenseActivation**](docs/Api/LicenseApi.md#licenseactivation) | **POST** /admin/license/activation | Activate license
*LicenseApi* | [**licenseGet**](docs/Api/LicenseApi.md#licenseget) | **GET** /admin/license | Get Current License Information
*LicenseApi* | [**licenseUpload**](docs/Api/LicenseApi.md#licenseupload) | **POST** /admin/license | Upload license key
*StatsApi* | [**enginesStatus**](docs/Api/StatsApi.md#enginesstatus) | **GET** /stat/engines | Engines Status
*StatsApi* | [**nodesStatus**](docs/Api/StatsApi.md#nodesstatus) | **GET** /stat/nodes | Nodes Status
*StatsApi* | [**productVersion**](docs/Api/StatsApi.md#productversion) | **GET** /version | Get Product Version
*YaraApi* | [**yaraPackageGenerate**](docs/Api/YaraApi.md#yarapackagegenerate) | **PUT** /yara/generate | Generate Yara package
*YaraApi* | [**yaraPackageStatus**](docs/Api/YaraApi.md#yarapackagestatus) | **GET** /yara/package | Yara Generation Status
*YaraApi* | [**yaraSourcesGet**](docs/Api/YaraApi.md#yarasourcesget) | **GET** /admin/config/yara/sources | Get Yara sources
*YaraApi* | [**yaraSourcesPut**](docs/Api/YaraApi.md#yarasourcesput) | **PUT** /admin/config/yara/sources | Modify Yara sources


## Documentation For Models

 - [AVEngineScanReport](docs/Model/AVEngineScanReport.md)
 - [AdminConfigSession](docs/Model/AdminConfigSession.md)
 - [AdminConfigUpdate](docs/Model/AdminConfigUpdate.md)
 - [AdminConfigUpdateDisabledupdate](docs/Model/AdminConfigUpdateDisabledupdate.md)
 - [AdminConfigWebhook](docs/Model/AdminConfigWebhook.md)
 - [AnalysisResult](docs/Model/AnalysisResult.md)
 - [AnalysisResultProcessInfo](docs/Model/AnalysisResultProcessInfo.md)
 - [AnalysisResultProcessInfoPostProcessing](docs/Model/AnalysisResultProcessInfoPostProcessing.md)
 - [BatchId](docs/Model/BatchId.md)
 - [BatchResponse](docs/Model/BatchResponse.md)
 - [BatchResponseBatchFiles](docs/Model/BatchResponseBatchFiles.md)
 - [BatchResponseBatchFilesFilesInBatch](docs/Model/BatchResponseBatchFilesFilesInBatch.md)
 - [BatchResponseBatchFilesProcessInfo](docs/Model/BatchResponseBatchFilesProcessInfo.md)
 - [BatchResponseProcessInfo](docs/Model/BatchResponseProcessInfo.md)
 - [BatchResponseScanResults](docs/Model/BatchResponseScanResults.md)
 - [DLPResponse](docs/Model/DLPResponse.md)
 - [DLPResponseDlpInfo](docs/Model/DLPResponseDlpInfo.md)
 - [DLPResponseDlpInfoHits](docs/Model/DLPResponseDlpInfoHits.md)
 - [DLPResponseDlpInfoHitsCcn](docs/Model/DLPResponseDlpInfoHitsCcn.md)
 - [DLPResponseDlpInfoMetadataRemoval](docs/Model/DLPResponseDlpInfoMetadataRemoval.md)
 - [DLPResponseDlpInfoRedact](docs/Model/DLPResponseDlpInfoRedact.md)
 - [DLPResponseDlpInfoWatermark](docs/Model/DLPResponseDlpInfoWatermark.md)
 - [DLPRuleMatchResult](docs/Model/DLPRuleMatchResult.md)
 - [DeepCDRDetails](docs/Model/DeepCDRDetails.md)
 - [DeepCDRDetailsDetails](docs/Model/DeepCDRDetailsDetails.md)
 - [FileInformation](docs/Model/FileInformation.md)
 - [InlineObject](docs/Model/InlineObject.md)
 - [InlineObject1](docs/Model/InlineObject1.md)
 - [InlineObject2](docs/Model/InlineObject2.md)
 - [InlineResponse200](docs/Model/InlineResponse200.md)
 - [InlineResponse2001](docs/Model/InlineResponse2001.md)
 - [InlineResponse20010](docs/Model/InlineResponse20010.md)
 - [InlineResponse20011](docs/Model/InlineResponse20011.md)
 - [InlineResponse20012](docs/Model/InlineResponse20012.md)
 - [InlineResponse20013](docs/Model/InlineResponse20013.md)
 - [InlineResponse2002](docs/Model/InlineResponse2002.md)
 - [InlineResponse2003](docs/Model/InlineResponse2003.md)
 - [InlineResponse2004](docs/Model/InlineResponse2004.md)
 - [InlineResponse2005](docs/Model/InlineResponse2005.md)
 - [InlineResponse2006](docs/Model/InlineResponse2006.md)
 - [InlineResponse2007](docs/Model/InlineResponse2007.md)
 - [InlineResponse2007Issues](docs/Model/InlineResponse2007Issues.md)
 - [InlineResponse2007IssuesGeneral](docs/Model/InlineResponse2007IssuesGeneral.md)
 - [InlineResponse2007IssuesSource](docs/Model/InlineResponse2007IssuesSource.md)
 - [InlineResponse2008](docs/Model/InlineResponse2008.md)
 - [InlineResponse2009](docs/Model/InlineResponse2009.md)
 - [InlineResponse400](docs/Model/InlineResponse400.md)
 - [InlineResponse403](docs/Model/InlineResponse403.md)
 - [InlineResponse500](docs/Model/InlineResponse500.md)
 - [LicenseInformation](docs/Model/LicenseInformation.md)
 - [MetascanReport](docs/Model/MetascanReport.md)
 - [MetascanReportScanDetails](docs/Model/MetascanReportScanDetails.md)
 - [NewUserRoleRequest](docs/Model/NewUserRoleRequest.md)
 - [NewUserRoleRequestRights](docs/Model/NewUserRoleRequestRights.md)
 - [NewUserRoleResponse](docs/Model/NewUserRoleResponse.md)
 - [NewUserRoleResponseAllOf](docs/Model/NewUserRoleResponseAllOf.md)
 - [ProcessingResultsIndexEnum](docs/Model/ProcessingResultsIndexEnum.md)
 - [ProcessingResultsStringEnum](docs/Model/ProcessingResultsStringEnum.md)
 - [RolePermissionObject](docs/Model/RolePermissionObject.md)
 - [ScanResultEnum](docs/Model/ScanResultEnum.md)
 - [SkipList](docs/Model/SkipList.md)
 - [StatNodesEngines](docs/Model/StatNodesEngines.md)
 - [StatNodesIssues](docs/Model/StatNodesIssues.md)
 - [StatNodesStatuses](docs/Model/StatNodesStatuses.md)
 - [UserLogin](docs/Model/UserLogin.md)
 - [UserRequest](docs/Model/UserRequest.md)
 - [UserRequestAllOf](docs/Model/UserRequestAllOf.md)
 - [UserResponse](docs/Model/UserResponse.md)
 - [VulnerabilityResponse](docs/Model/VulnerabilityResponse.md)
 - [VulnerabilityResponseResult](docs/Model/VulnerabilityResponseResult.md)
 - [VulnerabilityResponseResultDetails](docs/Model/VulnerabilityResponseResultDetails.md)
 - [VulnerabilityResponseResultDetailsCvss](docs/Model/VulnerabilityResponseResultDetailsCvss.md)
 - [VulnerabilityResponseResultDetectedProduct](docs/Model/VulnerabilityResponseResultDetectedProduct.md)
 - [VulnerabilityResponseResultDetectedProductProduct](docs/Model/VulnerabilityResponseResultDetectedProductProduct.md)
 - [VulnerabilityResponseResultDetectedProductVendor](docs/Model/VulnerabilityResponseResultDetectedProductVendor.md)
 - [VulnerabilityResponseResultDetectedProductVersionData](docs/Model/VulnerabilityResponseResultDetectedProductVersionData.md)
 - [VulnerabilityResponseResultVulnerabilites](docs/Model/VulnerabilityResponseResultVulnerabilites.md)
 - [YaraReport](docs/Model/YaraReport.md)
 - [YaraSourcesObject](docs/Model/YaraSourcesObject.md)
 - [YaraSourcesObjectHttpSources](docs/Model/YaraSourcesObjectHttpSources.md)
 - [YaraSourcesObjectLocalSources](docs/Model/YaraSourcesObjectLocalSources.md)


## Documentation For Authorization



## apikey


- **Type**: API key
- **API key parameter name**: apikey
- **Location**: HTTP header



## Author

feedback@opswat.com

