/*
 * vulnerability_response_result_detected_product.h
 *
 * Detected products object is present if input hash has been found to correspond to verified product
 */

#ifndef _vulnerability_response_result_detected_product_H_
#define _vulnerability_response_result_detected_product_H_

#include <string.h>
#include "../external/cJSON.h"
#include "../include/list.h"
#include "../include/keyValuePair.h"
#include "vulnerability_response_result_detected_product_product.h"
#include "vulnerability_response_result_detected_product_vendor.h"
#include "vulnerability_response_result_detected_product_version_data.h"

// Enum SEVERITY for vulnerability_response_result_detected_product

typedef enum  { metadefender_core_vulnerability_response_result_detected_product_SEVERITY_NULL = 0, metadefender_core_vulnerability_response_result_detected_product_SEVERITY_low, metadefender_core_vulnerability_response_result_detected_product_SEVERITY_moderate, metadefender_core_vulnerability_response_result_detected_product_SEVERITY_important, metadefender_core_vulnerability_response_result_detected_product_SEVERITY_critical, metadefender_core_vulnerability_response_result_detected_product_SEVERITY_not_available, metadefender_core_vulnerability_response_result_detected_product_SEVERITY_unknown } metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e;

char* vulnerability_response_result_detected_product_severity_ToString(metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e severity);

metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e vulnerability_response_result_detected_product_severity_FromString(char* severity);



typedef struct vulnerability_response_result_detected_product_t {
    int has_vulnerability; //boolean
    int is_current; //boolean
    struct vulnerability_response_result_detected_product_product_t *product; //model
    char *remediation_link; // string
    metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e severity; //enum
    char *sig_name; // string
    int signature; //numeric
    struct vulnerability_response_result_detected_product_vendor_t *vendor; //model
    char *version; // string
    struct vulnerability_response_result_detected_product_version_data_t *version_data; //model

} vulnerability_response_result_detected_product_t;

vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product_create(
    int has_vulnerability,
    int is_current,
    vulnerability_response_result_detected_product_product_t *product,
    char *remediation_link,
    metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e severity,
    char *sig_name,
    int signature,
    vulnerability_response_result_detected_product_vendor_t *vendor,
    char *version,
    vulnerability_response_result_detected_product_version_data_t *version_data
);

void vulnerability_response_result_detected_product_free(vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product);

vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product_parseFromJSON(cJSON *vulnerability_response_result_detected_productJSON);

cJSON *vulnerability_response_result_detected_product_convertToJSON(vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product);

#endif /* _vulnerability_response_result_detected_product_H_ */

