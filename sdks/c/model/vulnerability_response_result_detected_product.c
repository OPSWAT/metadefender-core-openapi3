#include <stdlib.h>
#include <string.h>
#include <stdio.h>
#include "vulnerability_response_result_detected_product.h"


char* severityvulnerability_response_result_detected_product_ToString(metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e severity) {
    char* severityArray[] =  { "NULL", "low", "moderate", "important", "critical", "not_available", "unknown" };
	return severityArray[severity];
}

metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e severityvulnerability_response_result_detected_product_FromString(char* severity){
    int stringToReturn = 0;
    char *severityArray[] =  { "NULL", "low", "moderate", "important", "critical", "not_available", "unknown" };
    size_t sizeofArray = sizeof(severityArray) / sizeof(severityArray[0]);
    while(stringToReturn < sizeofArray) {
        if(strcmp(severity, severityArray[stringToReturn]) == 0) {
            return stringToReturn;
        }
        stringToReturn++;
    }
    return 0;
}

vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product_create(
    int has_vulnerability,
    int is_current,
    vulnerability_response_result_detected_product_product_t *product,
    char *remediation_link,
    metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e severity,
    char *sig_name,
    int signature,
    vulnerability_response_result_detected_product_vendor_t *vendor,
    char *version,
    vulnerability_response_result_detected_product_version_data_t *version_data
    ) {
    vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product_local_var = malloc(sizeof(vulnerability_response_result_detected_product_t));
    if (!vulnerability_response_result_detected_product_local_var) {
        return NULL;
    }
    vulnerability_response_result_detected_product_local_var->has_vulnerability = has_vulnerability;
    vulnerability_response_result_detected_product_local_var->is_current = is_current;
    vulnerability_response_result_detected_product_local_var->product = product;
    vulnerability_response_result_detected_product_local_var->remediation_link = remediation_link;
    vulnerability_response_result_detected_product_local_var->severity = severity;
    vulnerability_response_result_detected_product_local_var->sig_name = sig_name;
    vulnerability_response_result_detected_product_local_var->signature = signature;
    vulnerability_response_result_detected_product_local_var->vendor = vendor;
    vulnerability_response_result_detected_product_local_var->version = version;
    vulnerability_response_result_detected_product_local_var->version_data = version_data;

    return vulnerability_response_result_detected_product_local_var;
}


void vulnerability_response_result_detected_product_free(vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product) {
    if(NULL == vulnerability_response_result_detected_product){
        return ;
    }
    listEntry_t *listEntry;
    vulnerability_response_result_detected_product_product_free(vulnerability_response_result_detected_product->product);
    free(vulnerability_response_result_detected_product->remediation_link);
    free(vulnerability_response_result_detected_product->sig_name);
    vulnerability_response_result_detected_product_vendor_free(vulnerability_response_result_detected_product->vendor);
    free(vulnerability_response_result_detected_product->version);
    vulnerability_response_result_detected_product_version_data_free(vulnerability_response_result_detected_product->version_data);
    free(vulnerability_response_result_detected_product);
}

cJSON *vulnerability_response_result_detected_product_convertToJSON(vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product) {
    cJSON *item = cJSON_CreateObject();

    // vulnerability_response_result_detected_product->has_vulnerability
    if(vulnerability_response_result_detected_product->has_vulnerability) { 
    if(cJSON_AddBoolToObject(item, "has_vulnerability", vulnerability_response_result_detected_product->has_vulnerability) == NULL) {
    goto fail; //Bool
    }
     } 


    // vulnerability_response_result_detected_product->is_current
    if(vulnerability_response_result_detected_product->is_current) { 
    if(cJSON_AddBoolToObject(item, "is_current", vulnerability_response_result_detected_product->is_current) == NULL) {
    goto fail; //Bool
    }
     } 


    // vulnerability_response_result_detected_product->product
    if(vulnerability_response_result_detected_product->product) { 
    cJSON *product_local_JSON = vulnerability_response_result_detected_product_product_convertToJSON(vulnerability_response_result_detected_product->product);
    if(product_local_JSON == NULL) {
    goto fail; //model
    }
    cJSON_AddItemToObject(item, "product", product_local_JSON);
    if(item->child == NULL) {
    goto fail;
    }
     } 


    // vulnerability_response_result_detected_product->remediation_link
    if(vulnerability_response_result_detected_product->remediation_link) { 
    if(cJSON_AddStringToObject(item, "remediation_link", vulnerability_response_result_detected_product->remediation_link) == NULL) {
    goto fail; //String
    }
     } 


    // vulnerability_response_result_detected_product->severity
    
    if(cJSON_AddStringToObject(item, "severity", severityvulnerability_response_result_detected_product_ToString(vulnerability_response_result_detected_product->severity)) == NULL)
    {
    goto fail; //Enum
    }
    


    // vulnerability_response_result_detected_product->sig_name
    if(vulnerability_response_result_detected_product->sig_name) { 
    if(cJSON_AddStringToObject(item, "sig_name", vulnerability_response_result_detected_product->sig_name) == NULL) {
    goto fail; //String
    }
     } 


    // vulnerability_response_result_detected_product->signature
    if(vulnerability_response_result_detected_product->signature) { 
    if(cJSON_AddNumberToObject(item, "signature", vulnerability_response_result_detected_product->signature) == NULL) {
    goto fail; //Numeric
    }
     } 


    // vulnerability_response_result_detected_product->vendor
    if(vulnerability_response_result_detected_product->vendor) { 
    cJSON *vendor_local_JSON = vulnerability_response_result_detected_product_vendor_convertToJSON(vulnerability_response_result_detected_product->vendor);
    if(vendor_local_JSON == NULL) {
    goto fail; //model
    }
    cJSON_AddItemToObject(item, "vendor", vendor_local_JSON);
    if(item->child == NULL) {
    goto fail;
    }
     } 


    // vulnerability_response_result_detected_product->version
    if(vulnerability_response_result_detected_product->version) { 
    if(cJSON_AddStringToObject(item, "version", vulnerability_response_result_detected_product->version) == NULL) {
    goto fail; //String
    }
     } 


    // vulnerability_response_result_detected_product->version_data
    if(vulnerability_response_result_detected_product->version_data) { 
    cJSON *version_data_local_JSON = vulnerability_response_result_detected_product_version_data_convertToJSON(vulnerability_response_result_detected_product->version_data);
    if(version_data_local_JSON == NULL) {
    goto fail; //model
    }
    cJSON_AddItemToObject(item, "version_data", version_data_local_JSON);
    if(item->child == NULL) {
    goto fail;
    }
     } 

    return item;
fail:
    if (item) {
        cJSON_Delete(item);
    }
    return NULL;
}

vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product_parseFromJSON(cJSON *vulnerability_response_result_detected_productJSON){

    vulnerability_response_result_detected_product_t *vulnerability_response_result_detected_product_local_var = NULL;

    // vulnerability_response_result_detected_product->has_vulnerability
    cJSON *has_vulnerability = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "has_vulnerability");
    if (has_vulnerability) { 
    if(!cJSON_IsBool(has_vulnerability))
    {
    goto end; //Bool
    }
    }

    // vulnerability_response_result_detected_product->is_current
    cJSON *is_current = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "is_current");
    if (is_current) { 
    if(!cJSON_IsBool(is_current))
    {
    goto end; //Bool
    }
    }

    // vulnerability_response_result_detected_product->product
    cJSON *product = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "product");
    vulnerability_response_result_detected_product_product_t *product_local_nonprim = NULL;
    if (product) { 
    product_local_nonprim = vulnerability_response_result_detected_product_product_parseFromJSON(product); //nonprimitive
    }

    // vulnerability_response_result_detected_product->remediation_link
    cJSON *remediation_link = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "remediation_link");
    if (remediation_link) { 
    if(!cJSON_IsString(remediation_link))
    {
    goto end; //String
    }
    }

    // vulnerability_response_result_detected_product->severity
    cJSON *severity = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "severity");
    metadefender_core_vulnerability_response_result_detected_product_SEVERITY_e severityVariable;
    if (severity) { 
    if(!cJSON_IsString(severity))
    {
    goto end; //Enum
    }
    severityVariable = severityvulnerability_response_result_detected_product_FromString(severity->valuestring);
    }

    // vulnerability_response_result_detected_product->sig_name
    cJSON *sig_name = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "sig_name");
    if (sig_name) { 
    if(!cJSON_IsString(sig_name))
    {
    goto end; //String
    }
    }

    // vulnerability_response_result_detected_product->signature
    cJSON *signature = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "signature");
    if (signature) { 
    if(!cJSON_IsNumber(signature))
    {
    goto end; //Numeric
    }
    }

    // vulnerability_response_result_detected_product->vendor
    cJSON *vendor = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "vendor");
    vulnerability_response_result_detected_product_vendor_t *vendor_local_nonprim = NULL;
    if (vendor) { 
    vendor_local_nonprim = vulnerability_response_result_detected_product_vendor_parseFromJSON(vendor); //nonprimitive
    }

    // vulnerability_response_result_detected_product->version
    cJSON *version = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "version");
    if (version) { 
    if(!cJSON_IsString(version))
    {
    goto end; //String
    }
    }

    // vulnerability_response_result_detected_product->version_data
    cJSON *version_data = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_detected_productJSON, "version_data");
    vulnerability_response_result_detected_product_version_data_t *version_data_local_nonprim = NULL;
    if (version_data) { 
    version_data_local_nonprim = vulnerability_response_result_detected_product_version_data_parseFromJSON(version_data); //nonprimitive
    }


    vulnerability_response_result_detected_product_local_var = vulnerability_response_result_detected_product_create (
        has_vulnerability ? has_vulnerability->valueint : 0,
        is_current ? is_current->valueint : 0,
        product ? product_local_nonprim : NULL,
        remediation_link ? strdup(remediation_link->valuestring) : NULL,
        severity ? severityVariable : -1,
        sig_name ? strdup(sig_name->valuestring) : NULL,
        signature ? signature->valuedouble : 0,
        vendor ? vendor_local_nonprim : NULL,
        version ? strdup(version->valuestring) : NULL,
        version_data ? version_data_local_nonprim : NULL
        );

    return vulnerability_response_result_detected_product_local_var;
end:
    return NULL;

}
