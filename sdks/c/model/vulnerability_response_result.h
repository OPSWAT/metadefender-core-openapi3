/*
 * vulnerability_response_result.h
 *
 * The result information provided by the OESIS Framework
 */

#ifndef _vulnerability_response_result_H_
#define _vulnerability_response_result_H_

#include <string.h>
#include "../external/cJSON.h"
#include "../include/list.h"
#include "../include/keyValuePair.h"
#include "vulnerability_response_result_detected_product.h"
#include "vulnerability_response_result_vulnerabilites.h"

// Enum METHOD for vulnerability_response_result

typedef enum  { metadefender_core_vulnerability_response_result_METHOD_NULL = 0, metadefender_core_vulnerability_response_result_METHOD__50700 } metadefender_core_vulnerability_response_result_METHOD_e;

char* vulnerability_response_result_method_ToString(metadefender_core_vulnerability_response_result_METHOD_e method);

metadefender_core_vulnerability_response_result_METHOD_e vulnerability_response_result_method_FromString(char* method);



typedef struct vulnerability_response_result_t {
    int code; //numeric
    char *hash; // string
    int method; //numeric
    char *timestamp; // string
    int timing; //numeric
    struct vulnerability_response_result_detected_product_t *detected_product; //model
    list_t *vulnerabilites; //nonprimitive container

} vulnerability_response_result_t;

vulnerability_response_result_t *vulnerability_response_result_create(
    int code,
    char *hash,
    int method,
    char *timestamp,
    int timing,
    vulnerability_response_result_detected_product_t *detected_product,
    list_t *vulnerabilites
);

void vulnerability_response_result_free(vulnerability_response_result_t *vulnerability_response_result);

vulnerability_response_result_t *vulnerability_response_result_parseFromJSON(cJSON *vulnerability_response_resultJSON);

cJSON *vulnerability_response_result_convertToJSON(vulnerability_response_result_t *vulnerability_response_result);

#endif /* _vulnerability_response_result_H_ */

