#include <stdlib.h>
#include <string.h>
#include <stdio.h>
#include "vulnerability_response_result_vulnerabilites.h"



vulnerability_response_result_vulnerabilites_t *vulnerability_response_result_vulnerabilites_create(
    char *description,
    vulnerability_response_result_details_t *details,
    char *severity,
    int severity_index,
    int static_id
    ) {
    vulnerability_response_result_vulnerabilites_t *vulnerability_response_result_vulnerabilites_local_var = malloc(sizeof(vulnerability_response_result_vulnerabilites_t));
    if (!vulnerability_response_result_vulnerabilites_local_var) {
        return NULL;
    }
    vulnerability_response_result_vulnerabilites_local_var->description = description;
    vulnerability_response_result_vulnerabilites_local_var->details = details;
    vulnerability_response_result_vulnerabilites_local_var->severity = severity;
    vulnerability_response_result_vulnerabilites_local_var->severity_index = severity_index;
    vulnerability_response_result_vulnerabilites_local_var->static_id = static_id;

    return vulnerability_response_result_vulnerabilites_local_var;
}


void vulnerability_response_result_vulnerabilites_free(vulnerability_response_result_vulnerabilites_t *vulnerability_response_result_vulnerabilites) {
    if(NULL == vulnerability_response_result_vulnerabilites){
        return ;
    }
    listEntry_t *listEntry;
    free(vulnerability_response_result_vulnerabilites->description);
    vulnerability_response_result_details_free(vulnerability_response_result_vulnerabilites->details);
    free(vulnerability_response_result_vulnerabilites->severity);
    free(vulnerability_response_result_vulnerabilites);
}

cJSON *vulnerability_response_result_vulnerabilites_convertToJSON(vulnerability_response_result_vulnerabilites_t *vulnerability_response_result_vulnerabilites) {
    cJSON *item = cJSON_CreateObject();

    // vulnerability_response_result_vulnerabilites->description
    if(vulnerability_response_result_vulnerabilites->description) { 
    if(cJSON_AddStringToObject(item, "description", vulnerability_response_result_vulnerabilites->description) == NULL) {
    goto fail; //String
    }
     } 


    // vulnerability_response_result_vulnerabilites->details
    if(vulnerability_response_result_vulnerabilites->details) { 
    cJSON *details_local_JSON = vulnerability_response_result_details_convertToJSON(vulnerability_response_result_vulnerabilites->details);
    if(details_local_JSON == NULL) {
    goto fail; //model
    }
    cJSON_AddItemToObject(item, "details", details_local_JSON);
    if(item->child == NULL) {
    goto fail;
    }
     } 


    // vulnerability_response_result_vulnerabilites->severity
    if(vulnerability_response_result_vulnerabilites->severity) { 
    if(cJSON_AddStringToObject(item, "severity", vulnerability_response_result_vulnerabilites->severity) == NULL) {
    goto fail; //String
    }
     } 


    // vulnerability_response_result_vulnerabilites->severity_index
    if(vulnerability_response_result_vulnerabilites->severity_index) { 
    if(cJSON_AddNumberToObject(item, "severity_index", vulnerability_response_result_vulnerabilites->severity_index) == NULL) {
    goto fail; //Numeric
    }
     } 


    // vulnerability_response_result_vulnerabilites->static_id
    if(vulnerability_response_result_vulnerabilites->static_id) { 
    if(cJSON_AddNumberToObject(item, "static_id", vulnerability_response_result_vulnerabilites->static_id) == NULL) {
    goto fail; //Numeric
    }
     } 

    return item;
fail:
    if (item) {
        cJSON_Delete(item);
    }
    return NULL;
}

vulnerability_response_result_vulnerabilites_t *vulnerability_response_result_vulnerabilites_parseFromJSON(cJSON *vulnerability_response_result_vulnerabilitesJSON){

    vulnerability_response_result_vulnerabilites_t *vulnerability_response_result_vulnerabilites_local_var = NULL;

    // vulnerability_response_result_vulnerabilites->description
    cJSON *description = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_vulnerabilitesJSON, "description");
    if (description) { 
    if(!cJSON_IsString(description))
    {
    goto end; //String
    }
    }

    // vulnerability_response_result_vulnerabilites->details
    cJSON *details = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_vulnerabilitesJSON, "details");
    vulnerability_response_result_details_t *details_local_nonprim = NULL;
    if (details) { 
    details_local_nonprim = vulnerability_response_result_details_parseFromJSON(details); //nonprimitive
    }

    // vulnerability_response_result_vulnerabilites->severity
    cJSON *severity = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_vulnerabilitesJSON, "severity");
    if (severity) { 
    if(!cJSON_IsString(severity))
    {
    goto end; //String
    }
    }

    // vulnerability_response_result_vulnerabilites->severity_index
    cJSON *severity_index = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_vulnerabilitesJSON, "severity_index");
    if (severity_index) { 
    if(!cJSON_IsNumber(severity_index))
    {
    goto end; //Numeric
    }
    }

    // vulnerability_response_result_vulnerabilites->static_id
    cJSON *static_id = cJSON_GetObjectItemCaseSensitive(vulnerability_response_result_vulnerabilitesJSON, "static_id");
    if (static_id) { 
    if(!cJSON_IsNumber(static_id))
    {
    goto end; //Numeric
    }
    }


    vulnerability_response_result_vulnerabilites_local_var = vulnerability_response_result_vulnerabilites_create (
        description ? strdup(description->valuestring) : NULL,
        details ? details_local_nonprim : NULL,
        severity ? strdup(severity->valuestring) : NULL,
        severity_index ? severity_index->valuedouble : 0,
        static_id ? static_id->valuedouble : 0
        );

    return vulnerability_response_result_vulnerabilites_local_var;
end:
    return NULL;

}
